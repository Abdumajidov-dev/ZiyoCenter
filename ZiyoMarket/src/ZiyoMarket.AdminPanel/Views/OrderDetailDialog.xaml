<Window x:Class="ZiyoMarket.AdminPanel.Views.OrderDetailDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Buyurtma tafsilotlari"
        Height="700" Width="800"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource MaterialDesignPaper}">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock FontSize="24" FontWeight="SemiBold">
                <Run Text="Buyurtma #"/>
                <Run Text="{Binding SelectedOrder.OrderNumber}"/>
            </TextBlock>
            <TextBlock Text="{Binding SelectedOrder.OrderDate, StringFormat='Sana: {0:dd.MM.yyyy HH:mm}'}"
                      FontSize="14"
                      Foreground="Gray"
                      Margin="0,5,0,0"/>
        </StackPanel>

        <!-- Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Order Info -->
                <materialDesign:Card Margin="0,0,0,15" Padding="20">
                    <StackPanel>
                        <TextBlock Text="Buyurtma ma'lumotlari"
                                  FontSize="18"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,15"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Mijoz:" FontWeight="SemiBold" Margin="0,5"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SelectedOrder.CustomerName}" Margin="0,5"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Sotuvchi:" FontWeight="SemiBold" Margin="0,5"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SelectedOrder.SellerName, TargetNullValue='Online'}" Margin="0,5"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Status:" FontWeight="SemiBold" Margin="0,5"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SelectedOrder.Status}" Margin="0,5"/>

                            <TextBlock Grid.Row="3" Grid.Column="0" Text="To'lov usuli:" FontWeight="SemiBold" Margin="0,5"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SelectedOrder.PaymentMethod}" Margin="0,5"/>

                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Yetkazish:" FontWeight="SemiBold" Margin="0,5"/>
                            <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding SelectedOrder.DeliveryType}" Margin="0,5"/>
                        </Grid>

                        <TextBlock Text="Yetkazish manzili:" FontWeight="SemiBold" Margin="0,10,0,5"
                                  Visibility="{Binding SelectedOrder.DeliveryAddress, Converter={StaticResource StringToVisibilityConverter}}"/>
                        <TextBlock Text="{Binding SelectedOrder.DeliveryAddress}"
                                  TextWrapping="Wrap"
                                  Visibility="{Binding SelectedOrder.DeliveryAddress, Converter={StaticResource StringToVisibilityConverter}}"/>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Order Items -->
                <materialDesign:Card Margin="0,0,0,15" Padding="20">
                    <StackPanel>
                        <TextBlock Text="Mahsulotlar"
                                  FontSize="18"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,15"/>

                        <DataGrid ItemsSource="{Binding SelectedOrder.Items}"
                                 AutoGenerateColumns="False"
                                 CanUserAddRows="False"
                                 CanUserDeleteRows="False"
                                 IsReadOnly="True"
                                 SelectionMode="Single"
                                 HeadersVisibility="Column">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Mahsulot" Width="*" Binding="{Binding ProductName}"/>
                                <DataGridTextColumn Header="Miqdor" Width="80" Binding="{Binding Quantity}"/>
                                <!--<DataGridTextColumn Header="Narx" Width="120" Binding="{Binding UnitPrice, StringFormat='{}{0:N0} so\'m'}"/>
                                <DataGridTextColumn Header="Chegirma" Width="100" Binding="{Binding DiscountAmount, StringFormat='{}{0:N0} so\'m'}"/>
                                <Data--><!--GridTextColumn Header="Jami" Width="120" Binding="{Binding TotalPrice, StringFormat='{}{0:N0} so\'m'}"/>-->
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Price Summary -->
                <materialDesign:Card Margin="0,0,0,15" Padding="20">
                    <StackPanel>
                        <TextBlock Text="Hisob-kitob"
                                  FontSize="18"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,15"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Jami summa:" Margin="0,5"/>
                            <!--<TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SelectedOrder.TotalPrice, StringFormat='{}{0:N0} so\'m'}" Margin="10,5,0,5"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Chegirma:" Margin="0,5"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SelectedOrder.DiscountApplied, StringFormat='{}{0:N0} so\'m'}" Margin="10,5,0,5" Foreground="Red"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Cashback:" Margin="0,5"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SelectedOrder.CashbackUsed, StringFormat='{}{0:N0} so\'m'}" Margin="10,5,0,5" Foreground="Orange"/>

                            <TextBlock Grid.Row="3" Grid.Column="0" Text="Yetkazish:" Margin="0,5"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SelectedOrder.DeliveryFee, StringFormat='{}{0:N0} so\'m'}" Margin="10,5,0,5"/>

                            <Separator Grid.Row="4" Grid.ColumnSpan="2" Margin="0,10"/>

                            <TextBlock Grid.Row="4" Grid.Column="0" Text="Yakuniy summa:" FontWeight="Bold" FontSize="16" Margin="0,10,0,5"/>
                            <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding SelectedOrder.FinalPrice, StringFormat='{}{0:N0} so\'m'}" FontWeight="Bold" FontSize="16" Margin="10,10,0,5"/>-->
                        </Grid>
                    </StackPanel>
                </materialDesign:Card>

                <!-- Notes -->
                <materialDesign:Card Padding="20">
                    <StackPanel>
                        <TextBlock Text="Eslatmalar"
                                  FontSize="18"
                                  FontWeight="SemiBold"
                                  Margin="0,0,0,15"/>

                        <TextBlock Text="Mijoz izohÐ¸:" FontWeight="SemiBold" Margin="0,5,0,5"
                                  Visibility="{Binding SelectedOrder.CustomerNotes, Converter={StaticResource StringToVisibilityConverter}}"/>
                        <TextBlock Text="{Binding SelectedOrder.CustomerNotes}"
                                  TextWrapping="Wrap"
                                  Margin="0,0,0,10"
                                  Visibility="{Binding SelectedOrder.CustomerNotes, Converter={StaticResource StringToVisibilityConverter}}"/>

                        <TextBlock Text="Sotuvchi izohi:" FontWeight="SemiBold" Margin="0,5,0,5"
                                  Visibility="{Binding SelectedOrder.SellerNotes, Converter={StaticResource StringToVisibilityConverter}}"/>
                        <TextBlock Text="{Binding SelectedOrder.SellerNotes}"
                                  TextWrapping="Wrap"
                                  Margin="0,0,0,10"
                                  Visibility="{Binding SelectedOrder.SellerNotes, Converter={StaticResource StringToVisibilityConverter}}"/>

                        <TextBlock Text="Admin izohi:" FontWeight="SemiBold" Margin="0,5,0,5"
                                  Visibility="{Binding SelectedOrder.AdminNotes, Converter={StaticResource StringToVisibilityConverter}}"/>
                        <TextBlock Text="{Binding SelectedOrder.AdminNotes}"
                                  TextWrapping="Wrap"
                                  Visibility="{Binding SelectedOrder.AdminNotes, Converter={StaticResource StringToVisibilityConverter}}"/>
                    </StackPanel>
                </materialDesign:Card>
            </StackPanel>
        </ScrollViewer>

        <!-- Close Button -->
        <Button Grid.Row="2"
               Content="Yopish"
               Style="{StaticResource MaterialDesignOutlinedButton}"
               Width="120"
               Height="40"
               Margin="0,20,0,0"
               HorizontalAlignment="Right"
               Click="CloseButton_Click"/>
    </Grid>
</Window>
